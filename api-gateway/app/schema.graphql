scalar DateTime

schema {
    query: Query
    mutation: Mutation
}




type Message {
    id: ID!
    thread: Thread!
    user_id: User!
    type: String
    paths: [String]
    created_at: DateTime!
    updated_at: DateTime!
    deleted_at: DateTime
}

type MessagesPage {
    items: [Message!]!
    next_cursor: String
    has_more: Boolean!
}

type User {
  id: ID!
  name: String
}





enum ChannelType {
    PUBLIC
    PRIVATE
}

type ChannelMember {
    id: ID!
    joined_at: Float!
}

input ChannelMemberInput {
    id: ID!
    joined_at: Float!
}

input CreateChannelInput {
  name: String!
  owner_id: String!
  users: [ChannelMemberInput!]!
  channel_type: ChannelType!
}

type Channel {
    id: ID
    name: String!
    owner_id: String!
    users: [ChannelMember!]!
    threads: [String!]!
    is_active: Boolean!
    channel_type: ChannelType!
    created_at: Float!
    updated_at: Float!
    deleted_at: Float
}



type User {
  id: ID!
  email: String!
  username: String!
  full_name: String
  is_active: Boolean!
}

type Token {
  access_token: String!
  token_type: String!
}



type Query {
    getMessage(thread_id: String!, user_id: String!): MessagesPage!

    getChannel(channel_id: String!): Channel!

    getUser(token: String!): User!
}

type Mutation {
    createMessage(thread_id: ID!, content: String!, type_: String!, paths: [String], user_id: String!): Message!
    updateMessage(thread_id: String!, message_id: String!, content: String!, type_: String!, paths: [String], user_id: String!): Message!
    deleteMessage(thread_id: String!, message_id: String!, user_id: String!): Boolean!

    createChannel(name: String!, owner_id: String!, users: [ChannelMemberInput!]!, channel_type: ChannelType!): Channel!
    updateChannel(channel_id: ID!, name: String!, owner_id: String!, channel_type: ChannelType!): Channel!
    deleteChannel(channel_id: ID!): ID!
    reactivateChannel(channel_id: ID!): ID!
}

createUser(email: String!, username: String!, password: String!, full_name: String): User!
updateUser(full_name: String): User!
loginUser(username_or_email: String!, password: String!): Token!


type Thread {
  id: ID!
  title: String
  author_id: ID
  category: String
  tags: [String]
  content: String
  created_at: DateTime
  updated_at: DateTime
}




extend type Query {
  # HomePage -> search channels by query string
  searchChannels(query: String!): [Channel!]!

  # ChannelPage -> search threads within a channel using multiple optional filters.
 
  searchThreads(
    channel_id: ID
    category: String
    author: String
    tag: String
    keyword: String
    start_date: String
    end_date: String
  ): [Thread!]!

  # ThreadPage -> search messages inside a thread
  searchMessages(thread_id: ID!, query: String): [Message!]!
}

